# Minimal Samba configuration optimized for macOS clients
# Place this file at: configs/etc/samba/smb.conf

[global]
   workgroup = WORKGROUP
   server string = %h Samba Server
   netbios name = %h
   security = user
   map to guest = Bad User

   # Prefer modern SMB for macOS (support SMB2/3)
   server min protocol = SMB2
   server max protocol = SMB3

   # macOS interoperability
   vfs objects = catia fruit streams_xattr
   fruit:metadata = stream
   fruit:resource = rsrc
   fruit:model = MacSamba
   fruit:posix_rename = yes
   fruit:wipe_intentionally_left_blank_rfork = yes
   catia:posix = yes
   streams_xattr:store = yes

   # ACL / extended attributes
   map acl inherit = Yes
   store dos attributes = Yes
   nt acl support = Yes

   # Locks and performance
   kernel oplocks = yes
   level2 oplocks = yes
   posix locking = yes
   socket options = TCP_NODELAY SO_RCVBUF=131072 SO_SNDBUF=131072

   # Logging
   log file = /var/log/samba/log.%m
   max log size = 1000
   syslog = 0

   # Misc
   load printers = no
   printing = bsd
   printcap name = /dev/null
   panic action = /usr/share/samba/panic-action %d

[homes]
   comment = Home Directories
   browseable = no
   read only = no
   create mask = 0700
   directory mask = 0700
   valid users = %S

# Note: the setup script will append an [opt] share (path = /opt) if missing.
# Adjust `workgroup`, `interfaces`, or additional shares to match your environment.
